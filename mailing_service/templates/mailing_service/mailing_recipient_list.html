{% extends 'mailing_service/base_inner.html' %}
{% load my_tags %}

{% block title %}Управление клиентами{% endblock %}

{% block inner_content%}
<h3 class="display-6">Список клиентов</h3>
<p class="lead text-white-50">Управление базой клиентов для рассылок</p>
{% if not user|in_group:'Менеджеры' %}
<div class="text-center">
    <p>
        <a class="btn btn-light" href="{% url 'mailing_service:create_client' %}" role="button">Добавить нового
            клиента</a>
    </p>
</div>
{% endif %}
<div class="container">
    <div class="card">
        <div class="card-body">
            <ul class="list-group list-group-numbered">
                {% for client in clients %}
                    {% if user == client.owner or perms.mailing_service.can_view_all_recipients or user.is_superuser %}
                <li class="list-group-item d-flex justify-content-between align-items-start">

                    <div class="ms-2 me-auto">
                        <div>{{client.name}}</div>
                    </div>
                    <a class="btn btn-outline-secondary btn-sm"
                       href="{% url 'mailing_service:detail_client' client.pk %}" role="button">Подробнее</a>

                    {% if user == client.owner or user.is_superuser %}
                    <div class="ms-2 btn-group" role="group">
                        <button type="button" class="btn btn-outline-secondary dropdown-toggle btn-sm"
                                data-bs-toggle="dropdown" aria-expanded="false">
                            Редактировать
                        </button>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="{% url 'mailing_service:update_client' client.pk %}"
                                   role="button">Изменить</a></li>
                            <li><a class="dropdown-item" href="{% url 'mailing_service:delete_client' client.pk %}"
                                   role="button">Удалить</a></li>
                        </ul>
                    </div>
                    {% endif %}
                </li>
                {% endif %}
                {% endfor %}

            </ul>
        </div>
    </div>
</div>
{% endblock %}

